<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
<title>Smart Power Documentation</title>

    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../wave/wave.css" rel="stylesheet" />
        <link href="../../../css/version-select.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Model maintenance";
        var mkdocs_page_input_path = "mesh\\model-maintenance\\ModelMaintenanceConcepts.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav is-active">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search fill-neutral--contrast">
      <a href="../../..">
          <img src="../../../logo.png" class="logo" alt="Logo"/>
        </a>

        <!-- A trick to place the version selector where I want it to be. -->
        <div class="icon-home" style="display: none;"></div><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Mesh</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../glossary/MeshGlossary/">Mesh Glossary</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../installation/MeshServiceInstallationGuide/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Calculations</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../calculations/calculations/">General</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Functions</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../calculations/functions/introduction/">Introduction</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >General</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/allocate_reserves/">Allocate_Reserves</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/at/">AT</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/color/">ColorARGB</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/compare/">Compare</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/concatenate/">Concatenate</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/copy_ts/">CopyTs</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/delta/">Delta</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/disable_cache/">DisableCache</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/getyfx/">GET_Y_FX</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/isvalid/">IsValid</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/linear/">Linear</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/max/">MAX</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/meshid/">MeshId</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/min/">MIN</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/parameter/">Parameter</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/pdlog/">PDLOG</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/reference_lookup/">Reference Lookup</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/restriction/">Restriction</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/revision/">Revision</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/set_ts_val_unit/">Set_Ts_Valunit</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/size/">Size</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/time_mask/">Time_Mask</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/tostring/">ToString</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/trace/">Trace</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/ts/">TS</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/unit_codes_for_set_ts_val_unit/">Unit Codes for Set_Ts_Valunit</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/valid/">Valid</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Forecast</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/get_best_forecast/">GetBestForecast</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/get_all_forecasts/">GetAllForecasts</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/get_forecast/">GetForecast</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/get_merged_forecast/">GetMergedForecasts</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >History</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/history/">About</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/get_ts_as_of_time/">GetTsAsOfTime</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/get_ts_historical_versions/">GetTsHistoricalVersions</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/get_ts_audit_times/">GetTsAuditTimes</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Logical</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/bool/">Bool</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/inside/">Inside</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/negative/">Negative</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/not/">Not</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/outside/">Outside</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/positive/">Positive</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Math</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/ts_gliding_average/">TS_GLIDING_AVERAGE</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/ts_gliding_gauss/">TS_GLIDING_GAUSS</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/ts_gliding_median/">TS_GLIDING_MEDIAN</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/ts_gliding_median_gauss/">TS_GLIDING_MEDIAN_GAUSS</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/gliding_trend_average/">GLIDING_TREND_AVERAGE</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/ts_acc_from/">TS_ACC_FROM</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/power/">POWER</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/abs/">ABS</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/ceil/">CEIL</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/floor/">FLOOR</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/integer/">INTEGER</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/log/">LOG</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/ln/">LN</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/round/">ROUND</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/round_integer/">ROUND_INTEGER</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/acos/">ACOS</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/asin/">ASIN</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/atan/">ATAN</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/cos/">COS</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/sin/">SIN</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/tan/">TAN</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Mix</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/mix/">MIX</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/mix_by_selecting_from_time_series_array/">MIX by selecting from time series array</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/mix0/">MIX0</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/tsiqfill/">TS_IQ-FILL</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Sim</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/convert_volume/">CONVERT_VOLUME</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/rating_curve/">RatingCurve</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/time_delayed/">TimeDelayed</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/xy/">XY</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/yx/">YX</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/zxy/">ZX_Y</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/zyx/">ZY_X</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Statistical</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/mean/">MEAN</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/normal/">Normal</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/percentile/">PERCENTILE</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/sum/">SUM</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Status</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/status/">About</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/reset_status/">RESET_STATUS</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/status_mask/">STATUS_MASK</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/status_count/">STATUS_COUNT</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Time</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/is_resolution/">IsResolution</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/is_time_valid/">IsTimeValid</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/push_ext_period/">PushExtPeriod</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/pop_ext_period/">PopExtPeriod</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/time/">Time</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/resolution/">Resolution</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/timespan/">TimeSpan</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/time_to_string/">TimeToString</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/time_examples/">Time Examples</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/time_point_information/">Time Point Information</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Transform</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/transform_what_when/">Which function can be used when</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/transform_terms/">Terms used in the functions</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/transform/">TRANSFORM</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/ts_expand/">TS_EXPAND</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/ts_offset/">TS_OFFSET</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/values_from_year/">ValuesFromYear</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/distribute/">DISTRIBUTE</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/trans_profile/">TRANS_PROFILE</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/profile/">PROFILE</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/profile_with_explicit_frequency/">PROFILE with explicit frequency</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/accumulate/">ACCUMULATE</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >VEE</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/validate_abs_limit/">ValidateAbsLimit</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/validate_delta_limit/">ValidateDeltaLimit</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/validate_delta_limit_extreme/">ValidateDeltaLimitExtreme</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/validate_repeat_value/">ValidateRepeatValue</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/correct_average_value/">CorrectAverageValue</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/correct_constant_value/">CorrectConstantValue</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/correct_copy_value/">CorrectCopyValue</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/correct_extrapolate/">CorrectExtrapolate</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../../calculations/functions/correct_interpolate/">CorrectInterpolate</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >gRPC</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../grpc/ClientCertificates/">Client certificates</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../grpc/Authorization/">Authorization</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../grpc/APISpecification/">API Specification</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../availability/availability/">Availability</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Model maintenance</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#model-definition-vs-model">"Model definition" vs "model"</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#the-energysystem-model-definition">The EnergySystem model definition</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#customer-extensions">Customer extensions</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#managing-customer-extensions">Managing customer extensions</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Mesh Data Transfer</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mesh-data-transfer/changelog/CHANGELOG/">Changelog</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mesh-data-transfer/general/general/">General</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mesh-data-transfer/configuration/configuration/">Configuration</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap is-active">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars is-active"></i>
          <a href="../../..">Smart Power Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Mesh</li>
      <li class="breadcrumb-item active">Model maintenance</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="general-introduction">General introduction</h1>
<p>Mesh operates under a few basic assumptions:</p>
<ul>
<li>Every object has a unique GUID.</li>
<li>Every object is able to do binary serialization (read/write).</li>
<li>Every object has an associated version number.</li>
</ul>
<h2 id="model-definition-vs-model">"Model definition" vs "model"</h2>
<p>A model definition is a description of a domain with respect to object types, attributes, and
relations. It defines what information is available through Mesh for this domain. An instance of
a model definition is simply called a "model". See also the <a href="../../glossary/MeshGlossary/">Mesh Glossary</a>.</p>
<h2 id="the-energysystem-model-definition">The <code>EnergySystem</code> model definition</h2>
<p>This is the Mesh model definition made by Volue to cover the information needed by the Mesh
connected modules. It defines the basic types to describe a hydro/thermal/wind system,
case management and time series quality related to this.  </p>
<h2 id="customer-extensions">Customer extensions</h2>
<p>An important point in Mesh modelling is the capability for customers, and specific projects,
to extend the <code>EnergySystem</code> model definition. This can be:</p>
<ul>
<li>Adding new attributes to existing types.</li>
<li>Modifying time series calculation expressions initially provided by Volue.</li>
<li>Modifying time series attributes to have an expression.</li>
<li>Adding new object types.</li>
<li>Making new connections between objects.</li>
</ul>
<p>This feature is widely used in large projects, but also applicable for smaller customers.</p>
<h3 id="managing-customer-extensions">Managing customer extensions</h3>
<p>Currently this is supported by use of Mesh namespaces. Changes made by customer/projects end up
in the <code>Custom</code> namespace. This basic configuration also prevents customers from making changes
on mandatory parts of the model definition. It's a simple solution while waiting for a full blown
authentication/authorization feature.</p>
<h1 id="current-process">Current process</h1>
<h2 id="master-model">Master model</h2>
<p>The master model definition is maintained through a server owned by Volue connected to an Oracle
database.</p>
<h2 id="model-definition-update">Model definition update</h2>
<p>Mesh model definitions can be exported into a binary file by using the <code>Model.ImportExport</code> tool.
These binaries normally have an .mdump extension and are not human-readable (and thus not suited
for regular version control systems). The scope of the export can be specified through CLI options.
The exports can also include the corresponding model instances from the model definitions.</p>
<p><code>Model.ImportExport</code> can also be used to import .mdump files into a target system in order to
perform an update of the model definition. A successful update of the model definition will include
saving the <em>target</em> binary file as a Mesh resource, located in a folder called <code>ObjectModelUpdates</code>.
The resource's name will consist of the name of the model definition and a timestamp. This storage
is actively used to retrieve the base for delta-based updates.</p>
<p>In practice, model definition updates are done by using a script called <code>ModelUpdate.ps1</code> which is
distributed alongside release packages. However, this document dwelves deeper into the underlying
process for updating, and indicates some of the problems that may arise along the way.</p>
<p>Throughout this document (and other literature) we'll use the term "model update" to refer to an
update of the model definition (as well as its derived models).</p>
<h3 id="delta-based-updates">Delta-based updates</h3>
<p>This is the preferred approach for model updates. It performs the following steps:</p>
<ul>
<li>Get the differences between the model definition which is currently installed on the target system
  (<code>Base</code>) and the new one to be installed (<code>New</code>). These can include:<ul>
<li>Objects that exist in both versions, but are different (marked for updating).</li>
<li>Objects that exist in <code>New</code> but not in <code>Base</code>, i.e. created after the <code>Base</code> installation
  (marked as new).</li>
<li>Objects that exist in <code>Base</code> but not in <code>New</code>, i.e. removed from the model definition since the
  <code>Base</code> installation (marked for deletion).</li>
</ul>
</li>
<li>Push the changes found in the previous point onto the target system.</li>
</ul>
<p>In our current process, <code>Base</code> is the latest master model definition which the customer has 
installed (and potentially expanded on) on the target system, and <code>New</code> is a newer master model
definition. The customer's own changes to the model definition are not taken into account when
calculating the delta between <code>Base</code> and <code>New</code>.</p>
<h3 id="assign-based-on-top-updates">Assign-based ("on-top") updates</h3>
<p>This approach should be avoided, but experience shows that this sometimes may be the only way to
fix some problematic cases. It's similar to forcing the model definition to change into a new state.</p>
<p>It performs the following steps:</p>
<ul>
<li>Push objects from the <code>New</code> model definition to the target system.</li>
<li>If the target system accepts the incoming changes, it becomes the new model definition.</li>
</ul>
<p>This operation does <em>not</em> delete anything, just stores unconditionally on top of the existing state.
Alternatively, it is possible to specify that only whatever's missing should be imported by passing
the <code>-w ImportOnlyMissingElementTypesAndDefinitions</code> option to the <code>Model.ImportExport</code> tool.</p>
<h1 id="challenges-related-to-current-approachtoolset">Challenges related to current approach/toolset</h1>
<h2 id="delta-based">Delta-based</h2>
<p>Prior to the last step (push), the <code>Model.ImportExport</code> tool will check the following:</p>
<ul>
<li>Problem D1: An object is marked as new on the, but this object <em>does</em> exist on the target system
  (based on ID lookup).</li>
<li>Problem D2: An object marked for updating does <em>not</em> exist on the target system.</li>
<li>Problem D3: An object marked for deletion does <em>not</em> exist on the target system.</li>
<li>Problem D4: An object is marked for updating, but is really a switch between a time series
  attribute being a calculation or not.</li>
<li>Problem D5: Version number conflicts. For example, pushing a version with a lower number than the
  target object's. In general, the versioning is <em>not</em> active by default on <code>Model.ImportExport</code>
  due to the lack of a global version number that can be applied across database instances.  </li>
</ul>
<p>The reason behind problems D1..D3 is hard to determine. Some probably come from the target system
missing validations and accepting operations that should not be allowed/authorized.
Another reason could be a wrong understanding of the latest installed master model definition
(<code>Base</code>) when doing version comparison.</p>
<p>An <a href="#assign-based-on-top-update">"on-top" update</a> can probably also lead to a situation like this,
for instance because parts that should be removed from the model definition are still not removed. </p>
<p>There exist some other problems as well:</p>
<ul>
<li>Problem D6: Assume that there have been changes to an expression both in the master model
  definition and the customer's target system. In this case the delta-based import will favor the
  changes from the master model definition over the customer's.</li>
<li>Problem D7: An attribute has been removed from the master model definition, and then recreated
  on master with the same name. Since the re-created object will now have a different GUID, this will
  appear as a new object in the delta update cause a duplicate name conflict on the target system.</li>
</ul>
<p>As a side note, in the past there had been issues arising from conflicts related to the usage of
<code>PDCTimeseriesReferenceEntity</code>, which is no longer used in our master model definitions. Since delta
updates only handle differences between two versions of master, this means that such conflicts
should no longer apply. Note that there can be still some <code>PDCTimeseriesReferenceEntity</code> objects in
the customers' own models, but they won't be affected by the delta import since they're created by
the customers themselves.</p>
<h2 id="assign-based-on-top">Assign-based ("on-top")</h2>
<p>The following problems can appear on this approach:</p>
<ul>
<li>Problem A1: Some enumeration values related to no value seem to be recreated (especially the
  <code>Undefined</code> value) with a new GUID. This <em>dangling</em> definition may also create problems on imports.</li>
<li>Problem A2: Because this approach does not delete anything, the target model definition may end up
  in a situation where leftovers from a previous version can create problems at some point.
  An immediate problem is e.g. when the master definition has changed the type of a given attribute, 
  such as from double to integer, which would change the attribute's GUID. If the attribute's name
  remains the same, a conflict would arise when trying to perform the update.</li>
<li>Problem A3: The version of the model definition stored in the <code>ObjectModelUpdates</code> resource folder
  will not give a correct picture of the updated state (ref Problem A2). This may create problems
  on later attempts to do delta-based updates.</li>
</ul>
<h1 id="example">Example</h1>
<p>Consider the following sequence:</p>
<p><img alt="" src="../MMConcepts_1.png" /></p>
<h3 id="step-1">Step 1</h3>
<p>A Mesh model definition (MD) is in a master state 1. It is installed on a target system.
This should be straightforward, no problems at all.</p>
<p>The MD 1 is also stored as a file inside Mesh Resources, within the <code>ObjectModelUpdates</code> folder.</p>
<h3 id="step-2">Step 2</h3>
<p>The master model definition is extended, and the version 3 is going to be updated on the target
system. There have been no customer changes on the MD on the target system at this point.
A delta update is provided from MD 3 "minus" MD 1, illustrated as triangle <code>a</code>. There should be
no problems doing this update.</p>
<p>The <code>ObjectModelUpdates</code> folder will now also contain the MD 3.</p>
<h3 id="step-3">Step 3</h3>
<p>Now we wish to update the target system to master version 6, but the MD on the target system has
been modified as well by the customer. However, as the figure shows, these changes merely extend
the target system's MD, but do not modify the "core" MD 3. The delta update <code>b</code> is done based on
master MD 6 minus master MD 3. There should be no problems doing this update either.</p>
<p>The <code>ObjectModelUpdates</code> folder will now also contain the MD 6.</p>
<h3 id="step-4">Step 4</h3>
<p>As before, we wish to update the target system to MD 7. However, in this case there have been
customer changes on core parts of the MD originating from master (represented by the two extra boxes
within the MD), so that the delta update <code>c</code> would be in conflict with such customer changes.
A merge conflict will happen in this case, with some of the problems indicated by D1..D4 above.</p>
<p>If there are changes on both master and target system, the master definition will be pushed.
In many cases this is accepted by the target system, so that the master MD is favored over the
local one.</p>
<h1 id="summary">Summary</h1>
<p>This document provides some background information on the process of model definition maintenance.
It shows that there are basic features in the tools supporting the maintenance process.
Experience shows that problems may arise, which must be worked around using miscellaneous cleanup
tools. In some cases, the only solution is to perform an "on-top" model update, which is <em>not</em>
usually recommended because it can cause further problems later on.</p>
              
            </div>
          </div><footer>
      <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
          <a href="../../availability/availability/" class="btn btn--outline btn--success float-left" title="Availability"><span class="icon icon-circle-arrow-left"></span> Previous</a>
          <a href="../../../mesh-data-transfer/changelog/CHANGELOG/" class="btn btn--outline btn--success float-right" title="Changelog">Next <span class="icon icon-circle-arrow-right"></span></a>
      </div>
  
    <hr/>
  
    <div role="contentinfo">
      <!-- Copyright etc -->
    </div>
  
    Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  </footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
    <span class="rst-current-version" data-toggle="rst-current-version is-active">
      
      
        <span><a href="../../availability/availability/" style="color: #fcfcfc">&laquo; Previous</a></span>
      
      
        <span><a href="../../../mesh-data-transfer/changelog/CHANGELOG/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
  </div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../../../search/main.js"></script>
      <script src="../../../js/version-select.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
